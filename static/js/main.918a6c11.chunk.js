(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{144:function(e,t,a){"use strict";a.r(t);a(77),a(102);var n=a(0),r=a.n(n),i=a(41),s=a.n(i),c=a(25),o=a.n(c),l=a(18),u=a(19),d=a(21),g=a(20),h=a(22),b=a(2),m=a(73),f=a.n(m),v=a(42),p=a.n(v),k=a(74),y=a.n(k),E=a(75),S=a.n(E),w=a(30),j=a.n(w),O=a(1),I=(a(72),a(23)),x={x:window.innerWidth,y:.9*window.innerHeight},C={backgroundColor:"rgba(248, 247, 216, 0.1)",position:"absolute",top:0,left:0,width:"100%",height:"100%"},D={backgroundColor:"#29b6f6",borderRadius:10,padding:5,margin:5,whiteSpace:"nowrap"},_={width:x.x,height:x.y,position:"absolute",backgroundColor:"#fff",backgroundPosition:"top",transformOrigin:"center ".concat(2*x.y,"px")},B={backgroundSize:"contain",backgroundRepeat:"no-repeat",overflow:"hidden",backgroundPosition:"center",height:x.y-300,width:x.x,margin:0,padding:0},P=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(d.a)(this,Object(g.a)(t).call(this,e))).state={id:e.id,debugServerInfo:e.debugServerInfo,users:[{id:1,avatar:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRCCqxQ--DqnBS4npIj956y0KQZP2H1-ZdHmsEb4pH9CiVsATBUhg",first_name:"\u041a\u043e\u0442\u044d\u043a",last_name:"\u041a\u043e\u0442\u044d\u043a\u043e\u0432",ages:15,interests:["\u041b\u0435\u0436\u0430\u0442\u044c","\u041c\u0443\u0440\u043a\u0430\u0442\u044c","\u041e\u0431\u043b\u0438\u0437\u044b\u0432\u0430\u0442\u044c\u0441\u044f","\u041a\u0443\u0448\u043e\u0442\u044c","\u041e\u0440\u0430\u0442\u044c"]},{id:2,avatar:"https://xn-----6kckiwadblcgjxwwirci4z.xn--p1ai/image/cache/catalog/vse-kartinki/sobaka/sobaka-068-800x800.jpg",first_name:"\u041f\u0451\u0441\u0438\u043a",last_name:"\u041f\u0451\u0441\u0438\u043a\u043e\u0432",ages:3,interests:["\u0413\u0430\u0432\u043a\u0430\u0442\u044c","\u0411\u0443\u0434\u0438\u0442\u044c \u0440\u0430\u043d\u043e","\u041f\u0438\u0441\u0438\u0442\u044c","\u0411\u0435\u0433\u0430\u0442\u044c","\u0411\u0435\u0433\u0430\u0442\u044c"]},{id:3,avatar:"https://xn-----6kckiwadblcgjxwwirci4z.xn--p1ai/image/cache/catalog/vse-kartinki/sobaka/sobaka-068-800x800.jpg",first_name:"\u0412\u0442\u043e\u0440\u043e\u0439 \u043f\u0451\u0441\u0438\u043a",last_name:"\u041f\u0451\u0441\u0438\u043a\u043e\u0432",ages:3,interests:["\u0413\u0430\u0432\u043a\u0430\u0442\u044c","\u0411\u0443\u0434\u0438\u0442\u044c \u0440\u0430\u043d\u043e","\u041f\u0438\u0441\u0438\u0442\u044c","\u0411\u0435\u0433\u0430\u0442\u044c","\u0411\u0435\u0433\u0430\u0442\u044c"]},{id:4,avatar:"https://xn-----6kckiwadblcgjxwwirci4z.xn--p1ai/image/cache/catalog/vse-kartinki/sobaka/sobaka-068-800x800.jpg",first_name:"\u0415\u0449\u0451 \u043e\u0434\u0438\u043d \u043f\u0451\u0441\u0438\u043a",last_name:"\u041f\u0451\u0441\u0438\u043a\u043e\u0432",ages:3,interests:["\u0413\u0430\u0432\u043a\u0430\u0442\u044c","\u0411\u0443\u0434\u0438\u0442\u044c \u0440\u0430\u043d\u043e","\u041f\u0438\u0441\u0438\u0442\u044c","\u0411\u0435\u0433\u0430\u0442\u044c","\u0411\u0435\u0433\u0430\u0442\u044c"]}],myInterests:["\u041f\u0438\u0441\u0438\u0442\u044c","\u041a\u0443\u0448\u043e\u0442\u044c","\u041e\u0440\u0430\u0442\u044c"],rot:0,moveBack:!1,shiftX:0,shiftY:0,debugInfo:"",limitOffset:30,userPicBackgroundColor:"",sizeX:x.x,sizeY:x.y,halfX:x.x/20,minchange:2},a.startX=0,a.startY=0,a.renderInterests=a.renderInterests.bind(Object(b.a)(Object(b.a)(a))),a.onMove=a.onMove.bind(Object(b.a)(Object(b.a)(a))),a.refreshUsers=a.refreshUsers.bind(Object(b.a)(Object(b.a)(a))),a.onEnd=a.onEnd.bind(Object(b.a)(Object(b.a)(a))),a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){}},{key:"onMove",value:function(e){var t=this.startX+e.shiftX,a=t/this.state.halfX,n="";(this.agree||this.disAgree)&&(n=this.agree?"rgba(0,0,255,.05)":"rgba(255,0,0,.05)"),this.setState({rot:a,moveBack:!1,userPicBackgroundColor:n,shiftX:t})}},{key:"onEnd",value:function(e){var t=this,a=this.state.debugInfo,n=this.state.users;(this.agree||this.disAgree)&&(this.agree?a+="+".concat(this.state.users[0].first_name):a+="-".concat(this.state.users[0].first_name));var r=5*this.state.rot;this.setState({userPicBackgroundColor:"",rot:r,debugInfo:a,moveBack:!1,shiftX:0,shiftY:0}),setTimeout(function(){n.splice(0,1),t.setState({rot:0,users:n,moveBack:!0})},500)}},{key:"refreshUsers",value:function(e){this.setState({users:[{id:1,avatar:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRCCqxQ--DqnBS4npIj956y0KQZP2H1-ZdHmsEb4pH9CiVsATBUhg",first_name:"\u041a\u043e\u0442\u044d\u043a",last_name:"\u041a\u043e\u0442\u044d\u043a\u043e\u0432",ages:15,interests:["\u041b\u0435\u0436\u0430\u0442\u044c","\u041c\u0443\u0440\u043a\u0430\u0442\u044c","\u041e\u0431\u043b\u0438\u0437\u044b\u0432\u0430\u0442\u044c\u0441\u044f","\u041a\u0443\u0448\u043e\u0442\u044c","\u041e\u0440\u0430\u0442\u044c"]},{id:2,avatar:"https://xn-----6kckiwadblcgjxwwirci4z.xn--p1ai/image/cache/catalog/vse-kartinki/sobaka/sobaka-068-800x800.jpg",first_name:"\u041f\u0451\u0441\u0438\u043a",last_name:"\u041f\u0451\u0441\u0438\u043a\u043e\u0432",ages:3,interests:["\u0413\u0430\u0432\u043a\u0430\u0442\u044c","\u0411\u0443\u0434\u0438\u0442\u044c \u0440\u0430\u043d\u043e","\u041f\u0438\u0441\u0438\u0442\u044c","\u0411\u0435\u0433\u0430\u0442\u044c","\u0411\u0435\u0433\u0430\u0442\u044c"]}]})}},{key:"getCircleRef",value:function(e){this.circleRef=e}},{key:"renderInterests",value:function(e){var t;t=[];var a=this.state.myInterests;return e.forEach(function(e){var n=D.backgroundColor;-1!==a.indexOf(e)&&(n="#0000ff"),t.push(r.a.createElement("span",{style:Object(I.a)({},D,{backgroundColor:n})},e))}),r.a.createElement(O.Div,{style:{lineHeight:"2.5",textAlign:"center"}},t)}},{key:"render",value:function(){var e=this.state,t=e.id,a=e.debugServerInfo,n=(e.refreshUsers,e.users),i=e.moveBack,s=(e.debugInfo,e.userPicBackgroundColor),c=e.rot;return r.a.createElement(O.Panel,{id:t,style:{overflow:"hidden"}},r.a.createElement(O.PanelHeader,null,a),r.a.createElement(O.Group,null,0!==n.length&&void 0!=n[0]&&r.a.createElement(O.Touch,{onMove:this.onMove,onEnd:this.onEnd,style:Object(I.a)({},_,{transition:i?"none":"transform .05s ease-out",transform:"rotate(".concat(c,"deg)")})},r.a.createElement(O.Div,{style:{height:"100%",padding:0}},r.a.createElement("div",{style:Object(I.a)({},C,{backgroundColor:s})}),r.a.createElement(O.Div,{style:Object(I.a)({},B,{backgroundImage:"url(".concat(n[0].avatar,")")})}),r.a.createElement("h1",{style:{textAlign:"center"}},r.a.createElement("strong",null,n[0].first_name," ",n[0].last_name)),this.renderInterests(n[0].interests))),0!==n.length&&void 0!=n[1]&&r.a.createElement(O.Div,{style:{padding:0,height:this.state.sizeY}},r.a.createElement(O.Div,{style:Object(I.a)({},B,{backgroundImage:"url(".concat(n[1].avatar,")")})}),r.a.createElement("h1",{style:{textAlign:"center"}},r.a.createElement("strong",null,n[1].first_name," ",n[1].last_name)),this.renderInterests(n[1].interests)),0===n.length&&r.a.createElement(O.Group,null,r.a.createElement("h1",null,"\u0411\u043e\u043b\u044c\u0448\u0435 \u043d\u0435\u0442\u0443. \u041c\u043e\u0436\u0435\u0448\u044c \u0441\u0431\u0440\u043e\u0441\u0438\u0442\u044c "),r.a.createElement(O.Button,{onClick:this.refreshUsers},"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c"))))}},{key:"agree",get:function(){var e=this.state,t=e.shiftX,a=e.limitOffset;return Math.abs(t)>a&&t>0}},{key:"disAgree",get:function(){var e=this.state,t=e.shiftX,a=e.limitOffset;return Math.abs(t)>a&&t<0}}]),t}(r.a.Component),A=(a(142),a(71),a(43)),z=a.n(A),T=(a(143),Object(O.platform)(),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(d.a)(this,Object(g.a)(t).call(this,e))).state={id:e.id,user:e.user,interests:[],debugInfo:"\u0422\u0443\u0442 \u0434\u0435\u0431\u0430\u0433",deNorm:"\u041d\u0443 \u0442\u0435\u0441\u0442\u044b"},a.getSuggestions=a.getSuggestions.bind(Object(b.a)(Object(b.a)(a))),a.renderInterests=a.renderInterests.bind(Object(b.a)(Object(b.a)(a))),a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){}},{key:"getSuggestions",value:function(e){if(this.setState({debugInfo:JSON.stringify(e.target.value)}),!(e.target.value.length<2)){var t=this;j.a.get("https://salert.info/interests/SearchFromQuery?str=".concat(e.target.value)).then(function(e){t.setState({debugInfo:JSON.stringify(e.data),interests:e.data})}).catch(function(e){t.setState({debugInfo:"\u041e\u0448\u0438\u0431\u043a\u0430 "+JSON.stringify(e)})})}}},{key:"renderInterests",value:function(){var e=this.state.interests;if(!e||e.length<1)return r.a.createElement(O.Div,null,"\u0418\u043d\u0442\u0435\u0440\u0435\u0441\u044b \u0442\u0438\u043f\u043e");var t=e.map(function(e){return r.a.createElement("option",{value:e.id},e.title)});return r.a.createElement(O.Select,{top:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0438\u043d\u0442\u0435\u0440\u0435\u0441 \u0438\u0437 \u0441\u043f\u0438\u0441\u043a\u0430",placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0438\u043d\u0442\u0435\u0440\u0435\u0441"},t)}},{key:"render",value:function(){var e=this.state,t=e.id,a=e.user,n=e.debugInfo,i=(e.interests,e.deNorm);return r.a.createElement(O.Panel,{id:t},r.a.createElement(O.PanelHeader,null,"\u041f\u0440\u043e\u0444\u0438\u043b\u044c"),a&&r.a.createElement(O.Group,{title:"\u041e\u0431\u0449\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0435"},r.a.createElement(O.Cell,{size:"m",before:r.a.createElement(O.Avatar,{src:a.photo_max_orig,size:80})},a.first_name," ",a.last_name)),a&&r.a.createElement(O.Group,{title:"\u041a\u043d\u043e\u043f\u043a\u0438 \u0441 \u0438\u043a\u043e\u043d\u043a\u0430\u043c\u0438"},r.a.createElement(O.Input,{onInput:this.getSuggestions,top:"\u041d\u0430\u0447\u043d\u0438\u0442\u0435 \u0432\u0432\u043e\u0434\u0438\u0442\u044c \u0434\u043b\u044f \u043f\u043e\u0434\u0441\u043a\u0430\u0437\u043a\u0438"}),r.a.createElement(this.renderInterests,null),r.a.createElement(O.Div,null,i),r.a.createElement(O.Div,null,n),r.a.createElement(O.Div,null,r.a.createElement(O.Button,{before:r.a.createElement(z.a,null),size:"l"},"Take a photo")),r.a.createElement(O.Div,null,r.a.createElement(O.Button,{level:"secondary",before:r.a.createElement(z.a,null),size:"l"},"Shuffle"))))}}]),t}(r.a.Component)),H=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(d.a)(this,Object(g.a)(t).call(this,e))).state={debug:!0,activeStory:{view:"cards",panel:"cards"},history:[{view:"cards",panel:"cards"}],user:void 0,debugServerInfo:"default"},a.onStoryChange=a.onStoryChange.bind(Object(b.a)(Object(b.a)(a))),a.renderDebug=a.renderDebug.bind(Object(b.a)(Object(b.a)(a))),a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;o.a.subscribe(function(t){switch(t.detail.type){case"VKWebAppGetUserInfoResult":e.setState({user:t.detail.data});var a=e;j.a.post("https://salert.info/user/GetUserData",t.detail.data).then(function(e){a.renderDebug(e.data,!1)}).catch(function(e){a.renderDebug(e,!0)});break;default:console.log(t.detail.type)}}),o.a.send("VKWebAppGetUserInfo",{})}},{key:"renderDebug",value:function(e,t){this.setState({debugServerInfo:t+JSON.stringify(e),activeStory:{view:"info",panel:"info"}})}},{key:"onStoryChange",value:function(e){var t=this.state.activeStory;t.view=e.currentTarget.dataset.view,this.setState({activeStory:t})}},{key:"render",value:function(){return r.a.createElement(O.Epic,{activeStory:this.state.activeStory.view,tabbar:r.a.createElement(O.Tabbar,null,r.a.createElement(O.TabbarItem,{onClick:this.onStoryChange,selected:"info"===this.state.activeStory.view,"data-view":"info",text:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c"},r.a.createElement(f.a,null)),r.a.createElement(O.TabbarItem,{onClick:this.onStoryChange,selected:"cards"===this.state.activeStory.view,"data-view":"cards",text:"\u041a\u0430\u0440\u0442\u043e\u0447\u043a\u0438"},r.a.createElement(S.a,null)),r.a.createElement(O.TabbarItem,{onClick:this.onStoryChange,selected:"base"===this.state.activeStory.view,"data-view":"base",text:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f"},r.a.createElement(y.a,null)),r.a.createElement(O.TabbarItem,{onClick:this.onStoryChange,selected:"settings"===this.state.activeStory.view,"data-view":"settings",text:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"},r.a.createElement(p.a,null)),r.a.createElement(O.TabbarItem,{onClick:this.onStoryChange,selected:"debug"===this.state.activeStory.view,"data-view":"debug",text:"\u0414\u0435\u0431\u0430\u0433"},r.a.createElement(p.a,null)))},r.a.createElement(O.View,{id:"info",activePanel:"info"},r.a.createElement(T,{id:"info",user:this.state.user})),r.a.createElement(O.View,{id:"cards",activePanel:"cards"},r.a.createElement(P,{id:"cards",debugServerInfo:this.state.debugServerInfo})),r.a.createElement(O.View,{id:"debug",activePanel:"debug"},r.a.createElement(O.Panel,{id:"debug"},r.a.createElement(O.PanelHeader,null,"Debug"),r.a.createElement(O.Div,null,this.state.debugServerInfo))))}}]),t}(r.a.Component);o.a.send("VKWebAppInit",{}),s.a.render(r.a.createElement(H,null),document.getElementById("root"))},76:function(e,t,a){e.exports=a(144)}},[[76,1,2]]]);
//# sourceMappingURL=main.918a6c11.chunk.js.map